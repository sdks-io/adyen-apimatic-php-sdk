# Donations

```php
$donationsApi = $client->getDonationsApi();
```

## Class Name

`DonationsApi`

## Methods

* [Get Donation Campaigns](../../doc/controllers/donations.md#get-donation-campaigns)
* [Create Donation](../../doc/controllers/donations.md#create-donation)


# Get Donation Campaigns

Queries the available donation campaigns for a donation based on the donation context (like merchant account, currency, and locale). The response contains active donation campaigns.

```php
function getDonationCampaigns(
    ?string $idempotencyKey = null,
    ?DonationCampaignsRequest $body = null
): ApiResponse
```

## Parameters

| Parameter | Type | Tags | Description |
|  --- | --- | --- | --- |
| `idempotencyKey` | `?string` | Header, Optional | A unique identifier for the message with a maximum of 64 characters (we recommend a UUID). |
| `body` | [`?DonationCampaignsRequest`](../../doc/models/donation-campaigns-request.md) | Body, Optional | - |

## Response Type

This method returns an [`ApiResponse`](../../doc/api-response.md) instance. The `getResult()` method on this instance returns the response data which is of type [`DonationCampaignsResponse`](../../doc/models/donation-campaigns-response.md).

## Example Usage

```php
$body = DonationCampaignsRequestBuilder::init(
    'EUR',
    'YOUR_MERCHANT_ACCOUNT'
)->build();

$donationsApi = $client->getDonationsApi();
$apiResponse = $donationsApi->getDonationCampaigns(
    null,
    $body
);

// Extracting response status code
var_dump($apiResponse->getStatusCode());
// Extracting response headers
var_dump($apiResponse->getHeaders());

if ($apiResponse->isSuccess()) {
    echo 'DonationCampaignsResponse:';
    var_dump($apiResponse->getResult());
} else {
    $error = $apiResponse->getResult();
    var_dump($error);
}
```

## Example Response *(as JSON)*

```json
{
  "donationCampaigns": [
    {
      "id": "DONATION_CAMPAIGN_ID",
      "campaignName": "DONATION_CAMPAIGN_NAME",
      "donation": {
        "currency": "EUR",
        "type": "fixedAmounts",
        "donationType": "fixedAmounts",
        "values": [
          100,
          200,
          300
        ]
      },
      "nonprofitName": "NONPROFIT_NAME",
      "causeName": "NONPROFIT_CAUSE",
      "nonprofitDescription": "NONPROFIT_DESCRIPTION.",
      "nonprofitUrl": "NONPROFIT_WEBSITE_URL",
      "logoUrl": "NONPROFIT_LOGO_URL",
      "bannerUrl": "NONPROFIT_BANNER_URL",
      "termsAndConditionsUrl": "NONPROFIT_TERMS_AND_CONDITIONS_URL"
    },
    {
      "id": "DONATION_CAMPAIGN_ID",
      "campaignName": "DONATION_CAMPAIGN_NAME",
      "donation": {
        "currency": "EUR",
        "type": "roundup",
        "donationType": "roundup",
        "maxRoundupAmount": 100
      },
      "nonprofitName": "NONPROFIT_NAME",
      "causeName": "NONPROFIT_CAUSE",
      "nonprofitDescription": "NONPROFIT_DESCRIPTION.",
      "nonprofitUrl": "NONPROFIT_WEBSITE_URL",
      "logoUrl": "NONPROFIT_LOGO_URL",
      "bannerUrl": "NONPROFIT_BANNER_URL",
      "termsAndConditionsUrl": "NONPROFIT_TERMS_AND_CONDITIONS_URL"
    }
  ]
}
```

## Errors

| HTTP Status Code | Error Description | Exception Class |
|  --- | --- | --- |
| 400 | Bad Request - a problem reading or understanding the request. | [`ServiceErrorException`](../../doc/models/service-error-exception.md) |
| 401 | Unauthorized - authentication required. | [`ServiceErrorException`](../../doc/models/service-error-exception.md) |
| 403 | Forbidden - insufficient permissions to process the request. | [`ServiceErrorException`](../../doc/models/service-error-exception.md) |
| 422 | Unprocessable Entity - a request validation error. | [`ServiceErrorException`](../../doc/models/service-error-exception.md) |
| 500 | Internal Server Error - the server could not process the request. | [`ServiceErrorException`](../../doc/models/service-error-exception.md) |


# Create Donation

Takes in the donation token generated by the `/payments` request and uses it to make the donation.

For more information, see [Donations](https://docs.adyen.com/online-payments/donations).

```php
function createDonation(?string $idempotencyKey = null, ?DonationPaymentRequest $body = null): ApiResponse
```

## Parameters

| Parameter | Type | Tags | Description |
|  --- | --- | --- | --- |
| `idempotencyKey` | `?string` | Header, Optional | A unique identifier for the message with a maximum of 64 characters (we recommend a UUID). |
| `body` | [`?DonationPaymentRequest`](../../doc/models/donation-payment-request.md) | Body, Optional | - |

## Response Type

This method returns an [`ApiResponse`](../../doc/api-response.md) instance. The `getResult()` method on this instance returns the response data which is of type [`DonationPaymentResponse`](../../doc/models/donation-payment-response.md).

## Example Usage

```php
$body = DonationPaymentRequestBuilder::init(
    Amount2Builder::init(
        'EUR',
        1000
    )->build(),
    'YOUR_MERCHANT_ACCOUNT',
    'YOUR_DONATION_REFERENCE',
    'https://your-company.example.com/...'
)
    ->donationCampaignId('DONATION_CAMPAIGN_ID')
    ->donationOriginalPspReference('991559660454807J')
    ->donationToken('YOUR_DONATION_TOKEN')
    ->paymentMethod(
        CardBuilder::init()
            ->type(Type12::SCHEME)
            ->build()
    )
    ->build();

$donationsApi = $client->getDonationsApi();
$apiResponse = $donationsApi->createDonation(
    null,
    $body
);

// Extracting response status code
var_dump($apiResponse->getStatusCode());
// Extracting response headers
var_dump($apiResponse->getHeaders());

if ($apiResponse->isSuccess()) {
    echo 'DonationPaymentResponse:';
    var_dump($apiResponse->getResult());
} else {
    $error = $apiResponse->getResult();
    var_dump($error);
}
```

## Example Response *(as JSON)*

```json
{
  "id": "UNIQUE_RESOURCE_ID",
  "status": "completed",
  "merchantAccount": "YOUR_MERCHANT_ACCOUNT",
  "amount": {
    "currency": "EUR",
    "value": 1000
  },
  "reference": "YOUR_DONATION_REFERENCE",
  "payment": {
    "pspReference": "8535762347980628",
    "resultCode": "Authorised",
    "amount": {
      "currency": "EUR",
      "value": 1000
    },
    "merchantReference": "YOUR_DONATION_REFERENCE"
  }
}
```

## Errors

| HTTP Status Code | Error Description | Exception Class |
|  --- | --- | --- |
| 400 | Bad Request - a problem reading or understanding the request. | [`ServiceErrorException`](../../doc/models/service-error-exception.md) |
| 401 | Unauthorized - authentication required. | [`ServiceErrorException`](../../doc/models/service-error-exception.md) |
| 403 | Forbidden - insufficient permissions to process the request. | [`ServiceErrorException`](../../doc/models/service-error-exception.md) |
| 422 | Unprocessable Entity - a request validation error. | [`ServiceErrorException`](../../doc/models/service-error-exception.md) |
| 500 | Internal Server Error - the server could not process the request. | [`ServiceErrorException`](../../doc/models/service-error-exception.md) |

